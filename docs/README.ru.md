# User Service (Микросервис пользователей)

__Этот микросервис предназначен для управления пользователями в проекте. Он отвечает за регистрацию, проверку пользователей и публикацию событий в Kafka. Может быть использован в других проектах при соответствующей настройке окружения.__

## Описание
Микросервис **User Service** отвечает за создание и проверку пользователей, а также отправку событий в Kafka. Он предоставляет API для регистрации и проверки пользователя, а также логирует все операции.

## Функциональность
- **Регистрация пользователя** – добавление в базу данных.
- **Проверка пользователя** – валидация логина и пароля.
- **Отправка событий в Kafka** – информирование других сервисов о регистрации пользователя.
- **Логирование** – запись запросов и ошибок.
- **Обработка ошибок** – централизованный middleware.

## Используемые технологии
- **Node.js** + **Express** – основной фреймворк.
- **PostgreSQL** – хранение данных пользователей.
- **Kafka (kafkajs)** – отправка событий.
- **Winston** – логирование.
- **Docker** – контейнеризация.

## Структура проекта
```
user-service/
│── src/
│   ├── config/           # Конфигурационные файлы (Kafka, DB)
│   ├── kafka/            # Kafka producer
│   ├── routes/           # API-маршруты
│   ├── services/         # Бизнес-логика (регистрация, проверка)
│   ├── utils/            # Логирование и вспомогательные функции
│   ├── app.ts            # Основное приложение
│   ├── server.ts         # Запуск сервера
│── docker-compose.yml    # Контейнеризация
│── README.md             # Описание проекта
```

## Установка и запуск
### Локальный запуск
```bash
yarn install
yarn start
```

### Запуск в Docker
```bash
docker-compose up --build
```

## Переменные окружения (.env)
```
PORT=4000
DB_HOST=database
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=secret
DB_NAME=users
KAFKA_BROKERS=kafka:9092
```

## API Маршруты
### Регистрация
- **POST** `/register` – Регистрация нового пользователя.
  - **Request Body:** `{ "login": "user", "password": "pass" }`
  - **Response:** `{ "message": "Пользователь зарегистрирован", "user": { "id": 1, "login": "user" } }`

### Проверка пользователя
- **POST** `/check-user` – Проверка логина и пароля.
  - **Request Body:** `{ "login": "user", "password": "pass" }`
  - **Response:** `{ "id": 1, "login": "user" }` (или `404 Not Found`)

## Логирование и мониторинг
- Логирование осуществляется через **Winston**.
- Ошибки обрабатываются централизованно.

## Автор
[Дорошев Кирилл (DKMfzf)](https://github.com/твой-гит)

## Лицензия
MIT
